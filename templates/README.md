# 批量导入模板使用说明

## 概述
本文档介绍如何使用CSV模板文件批量导入黑白名单数据到GLPI软件管理插件中。

## 模板文件格式

### CSV字段说明

| 字段名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| name | 文本 | ✅ | 软件名称 | Microsoft Office |
| version | 文本 | ❌ | 版本号 | 2021, 16.0.1 |
| publisher | 文本 | ❌ | 发布商 | Microsoft Corporation |
| category | 文本 | ❌ | 软件分类 | Office Suite, Graphics |
| priority | 数字 | ❌ | 优先级(0-100) | 10 |
| is_active | 数字 | ❌ | 是否启用(1=启用,0=禁用) | 1 |
| computers_id | 文本 | ❌ | 适用计算机ID(多个用逗号分隔) | 1,2,3 |
| users_id | 文本 | ❌ | 适用用户ID(多个用逗号分隔) | 10,20,30 |
| groups_id | 文本 | ❌ | 适用群组ID(多个用逗号分隔) | 5,8 |
| version_rules | 文本 | ❌ | 高级版本规则 | >2022.0, <3.0 |
| comment | 文本 | ❌ | 备注说明 | 办公软件套件 |

### 版本规则语法

支持以下版本比较规则：

- `>1.0` - 大于版本 1.0
- `<2.0` - 小于版本 2.0
- `1.0-2.0` - 版本范围 1.0 到 2.0（闭区间）
- `2.0.1` - 精确匹配指定版本

多个规则可以换行分别输入，每行一个规则。

### ID字段获取方法

#### 计算机ID获取
1. 进入GLPI主界面
2. 点击"资产" -> "计算机"
3. 在计算机列表中查看ID列

#### 用户ID获取
1. 进入GLPI主界面
2. 点击"管理" -> "用户"
3. 在用户列表中查看ID列

#### 群组ID获取
1. 进入GLPI主界面
2. 点击"管理" -> "群组"
3. 在群组列表中查看ID列

## 导入步骤

### 1. 下载模板
- 白名单模板：点击白名单页面的"下载模板"按钮
- 黑名单模板：点击黑名单页面的"下载模板"按钮

### 2. 编辑模板
1. 使用Excel、WPS或记事本打开CSV文件
2. 根据需要添加、修改数据行
3. 确保name字段不为空
4. 保存为UTF-8编码的CSV格式

### 3. 执行导入
1. 在对应的黑白名单页面点击"批量导入"
2. 选择编辑好的CSV文件
3. 配置导入选项：
   - ✅ 跳过重复项：推荐勾选，避免重复数据
   - ❌ 严格验证模式：可选，启用更严格的数据验证
4. 点击"开始导入"
5. 等待导入完成，查看结果统计

## 注意事项

### 文件格式要求
- 文件扩展名必须是 `.csv`
- 推荐使用UTF-8编码，避免中文乱码
- 第一行必须是字段标题，不要删除或修改
- 数据从第二行开始

### 数据要求
- 软件名称(name)不能为空
- 优先级范围：0-100
- is_active只能是0或1
- ID字段必须是有效的数字ID
- 版本规则语法要正确

### 常见错误
1. **文件编码问题**：使用记事本保存时选择UTF-8编码
2. **CSV格式问题**：确保使用逗号分隔，不要使用分号
3. **ID无效**：确保computers_id、users_id、groups_id是有效的ID
4. **重复数据**：相同软件名称会被跳过（如开启跳过重复项）

## 示例数据

### 白名单示例
```csv
name,version,publisher,category,priority,is_active,computers_id,users_id,groups_id,version_rules,comment
Microsoft Office,2021,Microsoft Corporation,Office Suite,10,1,,,,,办公软件套件
Adobe Photoshop,2023,Adobe Inc.,Graphics,8,1,,,,>2022.0,图像处理软件
```

### 黑名单示例
```csv
name,version,publisher,category,priority,is_active,computers_id,users_id,groups_id,version_rules,comment
BitTorrent,,BitTorrent Inc.,P2P,90,1,,,,,种子下载软件
QQ游戏,,Tencent,Game,70,1,,,,,游戏平台
```

## 支持与帮助

如果在导入过程中遇到问题，请：

1. 检查CSV文件格式是否正确
2. 确认必填字段是否为空
3. 验证ID字段是否有效
4. 查看导入结果中的错误信息
5. 联系系统管理员获取帮助

---

**版本**: v1.0.0  
**更新日期**: 2025年1月  
**作者**: Abner Liu